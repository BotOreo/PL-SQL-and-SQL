SELECT * FROM TAB;
-----cross join---------
SELECT ENAME,JOB,DNAME
FROM EMP CROSS JOIN DEPT;

----cross join (no condition)--------------
SELECT ENAME, JOB, DNAME
FROM EMP, DEPT;

----equi join (to match FK=PK)------------
SELECT EMPNO, ENAME, DEPTNO, DNAME
FROM EMP NATURAL JOIN DEPT;

SELECT EMPNO,ENAME,DEPTNO,DNAME
FROM EMP JOIN DEPT
USING(DEPTNO);

---------Using on join (need to use column identifier, the "dot" to ensure 
which column and from where to choose) to avoid ambiguity-----------------

SELECT EMPNO,ENAME,EMP.DEPTNO,DNAME
FROM EMP JOIN DEPT
ON EMP.DEPTNO=DEPT.DEPTNO;

---------Table aliases (shortern table names)------------------------------

SELECT EMPNO,ENAME,E.DEPTNO,DNAME
FROM EMP E JOIN DEPT D
ON E.DEPTNO=D.DEPTNO;

SELECT PT_LNAME, D.DOC_ID, DOC_NAME
FROM DOCTOR D JOIN PATIENT P
ON P.DOC_ID=D.DOC_ID
ORDER BY 2

----------non-equi join-----------------

SELECT EMPNO,ENAME,E.DEPTNO,DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO BETWEEN 10 AND 20

SELECT EMPNO,ENAME,E.DEPTNO,DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND E.DEPTNO BETWEEN 10 AND 20;


------------Self join (1 table treat as 2)-------------
SELECT WORKER.EMPNO,WORKER.ENAME,WORKER.MGR, BOSS.ENAME
FROM EMP WORKER, EMP BOSS
WHERE WORKER.MGR = BOSS.EMPNO;


SELECT WORKER.EMPNO,WORKER.ENAME,WORKER.MGR, BOSS.ENAME
FROM EMP WORKER JOIN EMP BOSS
ON WORKER.MGR = BOSS.EMPNO;

--------Left Join----------------------------------------

SELECT WORKER.EMPNO, WORKER.ENAME, WORKER.MGR, BOSS.ENAME
FROM EMP WORKER LEFT OUTER JOIN EMP BOSS
ON WORKER.MGR = BOSS.EMPNO;

SELECT WORKER.EMPNO, WORKER.ENAME, WORKER.MGR, BOSS.ENAME
FROM EMP WORKER, EMP BOSS
WHERE WORKER.MGR = BOSS.EMPNO (+);

----------Right join ------------------------------------

SELECT WORKER.EMPNO, WORKER.ENAME, WORKER.MGR, BOSS.ENAME
FROM EMP WORKER RIGHT OUTER JOIN EMP BOSS
ON WORKER.MGR = BOSS.EMPNO;

SELECT WORKER.EMPNO, WORKER.ENAME, WORKER.MGR, BOSS.ENAME
FROM EMP WORKER, EMP BOSS
WHERE WORKER.MGR(+)=BOSS.EMPNO;

----------------Full Join-----------------

SELECT WORKER.EMPNO, WORKER.ENAME, WORKER.MGR, BOSS.ENAME
FROM EMP WORKER FULL JOIN EMP BOSS
ON WORKER.MGR = BOSS.EMPNO;

----------------Assignment 4 Script -------------------

Question 1:

SELECT S.NAME, C.CUST_NAME, C.CITY AS "CUSTOMER CITY", S.CITY AS "SALESMAN CITY"
FROM CUSTOMERS C JOIN SALESMAN S
ON S.SALESMAN_ID = C.SALESMAN_ID
AND C.CITY=S.CITY;

Question 2:
SELECT O.ORD_NO,O.PURCH_AMT,C.CUST_NAME,C.CITY
FROM ORDERS O JOIN CUSTOMERS C
ON C.CUSTOMER_ID=O.CUSTOMER_ID
WHERE PURCH_AMT BETWEEN 500 AND 2000;

Question 3: 
SELECT C.CUST_NAME AS "CUSTOMER",S.NAME AS "SALESMAN"
FROM CUSTOMERS C LEFT JOIN SALESMAN S
ON C.SALESMAN_ID=S.SALESMAN_ID

Question 4:
SELECT C.CUST_NAME,S.COMMISSION
FROM CUSTOMERS C LEFT JOIN SALESMAN S
ON C.SALESMAN_ID=S.SALESMAN_ID
WHERE S.COMMISSION >0.12;

Question 5:
SELECT C.CUST_NAME,S.COMMISSION
FROM CUSTOMERS C LEFT JOIN SALESMAN S
ON C.SALESMAN_ID=S.SALESMAN_ID
WHERE C.CITY!=S.CITY 
AND S.COMMISSION >0.12;






